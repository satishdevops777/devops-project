# RoboShop ‚Äì RabbitMQ Service Setup

This document explains how to install and configure **RabbitMQ** for the RoboShop application. It is written in **GitHub-ready README.md format**, following **real-world DevOps / SRE practices**.

---

## üìå What is RabbitMQ in RoboShop?

**RabbitMQ** is a **message broker (message queue)** used for **asynchronous communication** between microservices.

In RoboShop, RabbitMQ helps to:

* Decouple services
* Handle background tasks
* Improve reliability and scalability

Some components publish messages, and other components consume them **without direct coupling**.

---

## üß± Technology Overview

| Component          | Details                     |
| ------------------ | --------------------------- |
| Message Broker     | RabbitMQ                    |
| Runtime Dependency | Erlang                      |
| OS                 | RHEL / CentOS / Rocky Linux |
| Service Manager    | systemd                     |

---

## ‚ö†Ô∏è Important Notes

* RabbitMQ **requires Erlang** to run
* Vendor-provided repositories are used to ensure compatibility
* Default credentials (`guest/guest`) **cannot be used remotely**
* A dedicated application user must be created

---

## 1Ô∏è‚É£ Configure Erlang Repository

### Why Erlang?

RabbitMQ is written in Erlang, so Erlang runtime must be installed first.

The vendor provides an automated script to configure the correct repository.

```bash
curl -s https://packagecloud.io/install/repositories/rabbitmq/erlang/script.rpm.sh | bash
```

This script:

* Adds the Erlang YUM repository
* Imports required GPG keys
* Prepares the system for RabbitMQ installation

---

## 2Ô∏è‚É£ Configure RabbitMQ Repository

### Why vendor repository?

Using the official RabbitMQ repository ensures:

* Correct version compatibility
* Security updates
* Stable builds

```bash
curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.rpm.sh | bash
```

---

## 3Ô∏è‚É£ Install RabbitMQ Server

```bash
dnf install rabbitmq-server -y
```

Verify installation:

```bash
rabbitmqctl status
```

---

## 4Ô∏è‚É£ Start and Enable RabbitMQ Service

### Enable RabbitMQ at boot

```bash
systemctl enable rabbitmq-server
```

### Start RabbitMQ service

```bash
systemctl start rabbitmq-server
```

### Check service status

```bash
systemctl status rabbitmq-server
```

Expected state:

```text
active (running)
```

---

## 5Ô∏è‚É£ Default Credentials Limitation

RabbitMQ ships with a default user:

```text
guest / guest
```

### Why it cannot be used?

* `guest` user is restricted to **localhost only**
* RoboShop services connect from **remote servers**

Hence, a dedicated application user is required.

---

## 6Ô∏è‚É£ Create Application User

### Add RabbitMQ user

```bash
rabbitmqctl add_user roboshop roboshop123
```

### Grant permissions

```bash
rabbitmqctl set_permissions -p / roboshop ".*" ".*" ".*"
```

### What this means

* `.*` ‚Üí full configure, write, and read access
* `/` ‚Üí default virtual host

---

## üîê Security Notes (Production Perspective)

In real production environments:

* Strong, rotated passwords are used
* TLS is enabled for RabbitMQ
* Permissions are restricted per vhost
* Access is limited using firewalls

RoboShop labs keep it simple for learning.

---

## üîÅ How RabbitMQ Fits in RoboShop Architecture

```text
Producer Service
 ‚Üí RabbitMQ Queue
 ‚Üí Consumer Service
```

This enables:

* Asynchronous processing
* Fault tolerance
* Loose coupling between services

---

## üö® Common Issues & Fixes

| Issue                 | Cause               | Fix                       |
| --------------------- | ------------------- | ------------------------- |
| RabbitMQ not starting | Erlang missing      | Reinstall Erlang repo     |
| Connection refused    | Service stopped     | Start rabbitmq-server     |
| Auth failure          | Using guest user    | Create app user           |
| Permission denied     | Missing permissions | Set permissions correctly |

---

## ‚úÖ Final Checklist

* [x] Erlang repo configured
* [x] RabbitMQ repo configured
* [x] RabbitMQ installed
* [x] Service running
* [x] Application user created
* [x] Permissions assigned

---

