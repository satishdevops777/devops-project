# RoboShop ‚Äì Catalogue Microservice Setup

This document explains **how to set up the Catalogue microservice** of the RoboShop application **step by step**, with clear explanations of *why* each step is required. This README is suitable for **GitHub**, **interviews**, and **real-world DevOps/SRE practice**.

---

## üìå What is the Catalogue Service?

The **Catalogue** service is a backend microservice responsible for:

* Serving the **list of products** displayed in the RoboShop UI
* Fetching product data from **MongoDB**
* Responding to frontend API requests like `/api/catalogue`

---

## üß± Technology Stack

| Component       | Technology                  |
| --------------- | --------------------------- |
| Language        | NodeJS (> 18)               |
| Database        | MongoDB                     |
| Service Manager | systemd                     |
| OS              | RHEL / CentOS / Rocky Linux |

---

## ‚ö†Ô∏è Important Notes

* The application is **custom-built**, not available as an RPM
* All setup steps are done **manually**
* The service must run as a **non-root user**
* MongoDB is a **remote dependency**

---

## 1Ô∏è‚É£ Install NodeJS 18

### Why?

The developer has specified that the application works only with **NodeJS version 18 or higher**. Older versions (like NodeJS 10) are unsupported and insecure.

### List available NodeJS modules

```bash
dnf module list nodejs
```

### Disable default NodeJS module

```bash
dnf module disable nodejs -y
```

### Enable NodeJS 18

```bash
dnf module enable nodejs:18 -y
```

### Install NodeJS

```bash
dnf install nodejs -y
```

### Verify installation

```bash
node -v
```

Expected output:

```text
v18.x.x
```

---

## 2Ô∏è‚É£ Create Application User

### Why?

Running applications as **root is insecure**. A dedicated system user improves isolation and security.

### Create user

```bash
useradd roboshop
```

> ‚ÑπÔ∏è `roboshop` is a **daemon user**, not intended for interactive login.

---

## 3Ô∏è‚É£ Create Application Directory

### Why `/app`?

Organizations usually standardize application locations for maintainability and automation.

```bash
mkdir /app
```

---

## 4Ô∏è‚É£ Download Application Code

### Download the catalogue application

```bash
curl -o /tmp/catalogue.zip https://roboshop-artifacts.s3.amazonaws.com/catalogue.zip
```

### Extract into `/app`

```bash
cd /app
unzip /tmp/catalogue.zip
```

This creates the NodeJS project structure, including:

* `server.js`
* `package.json`
* `schema/`

---

## 5Ô∏è‚É£ Install Application Dependencies

### Why?

NodeJS applications depend on external libraries defined in `package.json`.

```bash
cd /app
npm install
```

This downloads all required dependencies into `node_modules/`.

---

## 6Ô∏è‚É£ Configure systemd Service

### Why systemd?

Using systemd provides:

* Auto-start on reboot
* Crash recovery
* Centralized logging

---

### Create service file

```bash
vim /etc/systemd/system/catalogue.service
```

### Service definition

```ini
[Unit]
Description=Catalogue Service

[Service]
User=roboshop
Environment=MONGO=true
Environment=MONGO_URL="mongodb://<MONGODB-SERVER-IPADDRESS>:27017/catalogue"
ExecStart=/bin/node /app/server.js
SyslogIdentifier=catalogue

[Install]
WantedBy=multi-user.target
```

> ‚ö†Ô∏è Replace `<MONGODB-SERVER-IPADDRESS>` with the actual MongoDB server IP.

---

## 7Ô∏è‚É£ Load and Start the Service

### Reload systemd

```bash
systemctl daemon-reload
```

### Enable service at boot

```bash
systemctl enable catalogue
```

### Start service

```bash
systemctl start catalogue
```

### Verify status

```bash
systemctl status catalogue
```

---

## 8Ô∏è‚É£ Install MongoDB Client

### Why?

The catalogue service requires product data to be loaded into MongoDB. We only need the **MongoDB client**, not the server.

### Create MongoDB repo

```bash
vim /etc/yum.repos.d/mongo.repo
```

```ini
[mongodb-org-4.2]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.2/x86_64/
gpgcheck=0
enabled=1
```

### Install MongoDB shell

```bash
dnf install mongodb-org-shell -y
```

---

## 9Ô∏è‚É£ Load Catalogue Schema

### Why?

Without schema data:
* MongoDB is empty
* Catalogue API returns no products

### Load schema

```bash
mongo --host <MONGODB-SERVER-IPADDRESS> </app/schema/catalogue.js
```

This inserts product data into the `catalogue` database.

---

## üîü Update Frontend Configuration

### Why?

The frontend (Nginx) must know where the catalogue service is running.

### Config file

```text
/etc/nginx/default.d/roboshop.conf
```

### Update catalogue route

```nginx
location /api/catalogue/ {
  proxy_pass http://<CATALOGUE-SERVER-IP>:8080;
}
```

Reload Nginx after changes.

---

## üîÅ End-to-End Request Flow

```text
Browser
 ‚Üí Nginx Frontend
 ‚Üí /api/catalogue
 ‚Üí Catalogue NodeJS Service
 ‚Üí MongoDB
 ‚Üí Product List
 ‚Üí Browser
```

---

## ‚úÖ Final Checklist

* [x] NodeJS 18 installed
* [x] roboshop user created
* [x] Application code deployed
* [x] Dependencies installed
* [x] systemd service running
* [x] MongoDB schema loaded
* [x] Frontend routing updated

---

