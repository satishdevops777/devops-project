# RoboShop ‚Äì Shipping Microservice Setup

This document explains how to install, configure, and run the **Shipping microservice** of the RoboShop e-commerce application. It is written in **GitHub-ready README.md format**, following **real-world DevOps / SRE practices**.

---

## üìå What is the Shipping Service?

The **Shipping** service is responsible for:

* Calculating the **distance** for delivery
* Computing **shipping charges** based on distance and cart details

It interacts with:

* **Cart service** (to fetch cart details)
* **MySQL database** (to store shipping-related data)

---

## üß± Technology Stack

| Component       | Technology                  |
| --------------- | --------------------------- |
| Language        | Java                        |
| Build Tool      | Maven (>= 3.5)              |
| Java Version    | >= 1.8                      |
| Database        | MySQL 5.7                   |
| Service Manager | systemd                     |
| OS              | RHEL / CentOS / Rocky Linux |

---

## ‚ö†Ô∏è Important Notes

* The Shipping service is a **custom-built Java application**
* It is **not available as an RPM**
* All configuration steps are done **manually**
* The service must run as a **non-root user**

---

## 1Ô∏è‚É£ Install Java & Maven

### Why Maven?

Maven is used to:

* Download Java dependencies
* Build the application
* Automatically install Java as a dependency

The developer has confirmed:

* Java version **>= 1.8**
* Maven version **>= 3.5**

---

### Install Maven (and Java)

```bash
dnf install maven -y
```

### Verify installation

```bash
java -version
mvn -version
```

---

## 2Ô∏è‚É£ Create Application User

### Why?

Running applications as **root is insecure**. A dedicated daemon user provides isolation and security.

```bash
useradd roboshop
```

> ‚ÑπÔ∏è `roboshop` is a system user used only to run RoboShop services.

---

## 3Ô∏è‚É£ Create Application Directory

```bash
mkdir /app
```

### Why `/app`?

Using a standard directory simplifies automation, monitoring, and troubleshooting.

---

## 4Ô∏è‚É£ Download Shipping Service Code

```bash
curl -L -o /tmp/shipping.zip https://roboshop-artifacts.s3.amazonaws.com/shipping.zip
```

Extract application code:

```bash
cd /app
unzip /tmp/shipping.zip
```

This creates the Java project structure including:

* `pom.xml`
* `src/`

---

## 5Ô∏è‚É£ Build the Application

### Why build is required?

Java applications must be compiled and packaged before execution.

---

### Build using Maven

```bash
cd /app
mvn clean package
```

This generates a JAR file under:

```text
target/shipping-1.0.jar
```

---

### Rename JAR for simplicity

```bash
mv target/shipping-1.0.jar shipping.jar
```

---

## 6Ô∏è‚É£ Configure systemd Service

### Why systemd?

Using systemd provides:

* Automatic startup on reboot
* Crash recovery
* Centralized logging

---

### Create service file

```bash
vim /etc/systemd/system/shipping.service
```

---

### Shipping service definition

```ini
[Unit]
Description=Shipping Service

[Service]
User=roboshop
Environment=CART_ENDPOINT=<CART-SERVER-IPADDRESS>:8080
Environment=DB_HOST=<MYSQL-SERVER-IPADDRESS>
ExecStart=/bin/java -jar /app/shipping.jar
SyslogIdentifier=shipping

[Install]
WantedBy=multi-user.target
```

> ‚ö†Ô∏è Replace `<CART-SERVER-IPADDRESS>` and `<MYSQL-SERVER-IPADDRESS>` with actual IP addresses.

---

## 7Ô∏è‚É£ Load and Start the Service

### Reload systemd

```bash
systemctl daemon-reload
```

---

### Enable service at boot

```bash
systemctl enable shipping
```

---

### Start service

```bash
systemctl start shipping
```

---

### Verify service status

```bash
systemctl status shipping
```

Expected state:

```text
active (running)
```

---

## üîÅ Shipping Service Request Flow

```text
Browser
 ‚Üí Nginx Frontend
 ‚Üí /api/shipping
 ‚Üí Shipping Java Service
 ‚Üí Cart Service
 ‚Üí MySQL Database
 ‚Üí Shipping Cost
 ‚Üí Browser
```

---

## üö® Common Issues & Fixes

| Issue                | Cause               | Fix                 |
| -------------------- | ------------------- | ------------------- |
| Service not starting | Java/Maven missing  | Install maven       |
| Cart API failure     | Wrong CART_ENDPOINT | Verify Cart service |
| DB connection error  | Wrong DB_HOST       | Verify MySQL server |
| JAR not found        | Build failed        | Re-run mvn package  |

---

## ‚úÖ Final Checklist

* [x] Java & Maven installed
* [x] roboshop user created
* [x] Application code deployed
* [x] JAR built successfully
* [x] systemd service configured
* [x] Cart service reachable
* [x] MySQL reachable

---

