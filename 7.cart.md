# RoboShop ‚Äì Cart Microservice Setup

This document explains how to install, configure, and run the **Cart microservice** of the RoboShop e-commerce application. It is written in **GitHub-ready README.md format**, following real-world **DevOps / SRE practices**.

---

## üìå What is the Cart Service?

The **Cart** service is a backend microservice responsible for:

* Adding items to a user‚Äôs cart
* Removing items from the cart
* Retrieving cart contents

It works closely with:

* **Redis** for cart data storage
* **Catalogue service** to fetch product details

---

## üß± Technology Stack

| Component          | Technology                  |
| ------------------ | --------------------------- |
| Language           | NodeJS (> 18)               |
| Cache / DB         | Redis                       |
| Dependency Service | Catalogue                   |
| Service Manager    | systemd                     |
| OS                 | RHEL / CentOS / Rocky Linux |

---

## ‚ö†Ô∏è Important Notes

* The Cart service is a **custom application** (not an RPM package)
* All setup steps must be done **manually**
* The service must run as a **non-root user**
* Redis and Catalogue are **external dependencies**

---

## 1Ô∏è‚É£ Install NodeJS 18

### Why?

The developer has specified that the Cart service requires **NodeJS version 18 or higher**. Older versions are unsupported.

---

### List available NodeJS modules

```bash
dnf module list nodejs
```

---

### Disable default NodeJS module

```bash
dnf module disable nodejs -y
```

---

### Enable NodeJS 18 module

```bash
dnf module enable nodejs:18 -y
```

---

### Install NodeJS

```bash
dnf install nodejs -y
```

---

### Verify installation

```bash
node -v
```

Expected output:

```text
v18.x.x
```

---

## 2Ô∏è‚É£ Create Application User

### Why?

Running applications as **root is insecure**. A dedicated daemon user improves isolation and security.

```bash
useradd roboshop
```

> ‚ÑπÔ∏è `roboshop` is a system/daemon user, not intended for interactive login.

---

## 3Ô∏è‚É£ Create Application Directory

```bash
mkdir /app
```

### Why `/app`?

Using a standard directory simplifies automation, monitoring, and troubleshooting.

---

## 4Ô∏è‚É£ Download Cart Service Code

```bash
curl -L -o /tmp/cart.zip https://roboshop-artifacts.s3.amazonaws.com/cart.zip
```

Extract application code:

```bash
cd /app
unzip /tmp/cart.zip
```

This creates the NodeJS project structure including:

* `server.js`
* `package.json`

---

## 5Ô∏è‚É£ Install Application Dependencies

```bash
cd /app
npm install
```

### What this does

* Reads `package.json`
* Downloads required NodeJS libraries
* Creates `node_modules/`

---

## 6Ô∏è‚É£ Configure systemd Service

### Why systemd?

Using systemd provides:

* Automatic service startup on reboot
* Process supervision and restart
* Centralized logging

---

### Create service file

```bash
vim /etc/systemd/system/cart.service
```

---

### Cart service definition

```ini
[Unit]
Description=Cart Service

[Service]
User=roboshop
Environment=REDIS_HOST=<REDIS-SERVER-IP>
Environment=CATALOGUE_HOST=<CATALOGUE-SERVER-IP>
Environment=CATALOGUE_PORT=8080
ExecStart=/bin/node /app/server.js
SyslogIdentifier=cart

[Install]
WantedBy=multi-user.target
```

> ‚ö†Ô∏è Replace `<REDIS-SERVER-IP>` and `<CATALOGUE-SERVER-IP>` with actual IP addresses.

---

## 7Ô∏è‚É£ Load and Start the Service

### Reload systemd

```bash
systemctl daemon-reload
```

---

### Enable service at boot

```bash
systemctl enable cart
```

---

### Start service

```bash
systemctl start cart
```

---

### Verify service status

```bash
systemctl status cart
```

Expected state:

```text
active (running)
```

---

## üîÅ Cart Service Request Flow

```text
Browser
 ‚Üí Nginx Frontend
 ‚Üí /api/cart
 ‚Üí Cart NodeJS Service
 ‚Üí Redis (cart data)
 ‚Üí Catalogue Service (product info)
 ‚Üí Response to browser
```

---

## üö® Common Issues & Fixes

| Issue                  | Cause                | Fix                         |
| ---------------------- | -------------------- | --------------------------- |
| Service not starting   | Wrong NodeJS version | Install NodeJS 18           |
| Redis connection error | Redis unreachable    | Check Redis bind & firewall |
| Catalogue API failure  | Wrong host/port      | Verify Catalogue service    |
| Permission denied      | Wrong user           | Ensure `User=roboshop`      |

---

## ‚úÖ Final Checklist

* [x] NodeJS 18 installed
* [x] roboshop user created
* [x] Application code deployed
* [x] Dependencies installed
* [x] systemd service configured
* [x] Redis connectivity verified
* [x] Catalogue connectivity verified

---

