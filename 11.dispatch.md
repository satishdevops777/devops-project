# RoboShop ‚Äì Dispatch Microservice Setup

This document explains how to install, configure, and run the **Dispatch microservice** of the RoboShop e-commerce application. It is written in **GitHub-ready README.md format**, aligned with **real-world DevOps / SRE practices**.

---

## üìå What is the Dispatch Service?

The **Dispatch** service is responsible for:

* Dispatching the product **after a successful purchase**
* Consuming messages from **RabbitMQ**
* Performing post-payment fulfillment actions

It works asynchronously and does **not interact directly with the frontend**.

---

## üß± Technology Stack

| Component       | Technology                  |
| --------------- | --------------------------- |
| Language        | GoLang                      |
| Messaging       | RabbitMQ                    |
| Build Tool      | Go Modules                  |
| Service Manager | systemd                     |
| OS              | RHEL / CentOS / Rocky Linux |

---

## ‚ö†Ô∏è Important Notes

* Dispatch is a **custom-built Go application**
* It is **not available as an RPM**
* All setup steps are done **manually**
* The service must run as a **non-root user**

---

## 1Ô∏è‚É£ Install GoLang

### Why GoLang?

The developer has implemented the Dispatch service in **GoLang**, so the Go runtime and toolchain are required to build and run the service.

---

### Install GoLang

```bash
dnf install golang -y
```

### Verify installation

```bash
go version
```

---

## 2Ô∏è‚É£ Create Application User

### Why?

Running applications as **root is insecure**. A dedicated daemon user ensures better isolation and security.

```bash
useradd roboshop
```

> ‚ÑπÔ∏è `roboshop` is a system user used only to run RoboShop services.

---

## 3Ô∏è‚É£ Create Application Directory

```bash
mkdir /app
```

### Why `/app`?

Using a standard directory simplifies automation, monitoring, and troubleshooting.

---

## 4Ô∏è‚É£ Download Dispatch Service Code

```bash
curl -L -o /tmp/dispatch.zip https://roboshop-artifacts.s3.amazonaws.com/dispatch.zip
```

Extract application code:

```bash
cd /app
unzip /tmp/dispatch.zip
```

This creates the Go application source files.

---

## 5Ô∏è‚É£ Build the Dispatch Application

### Why build is required?

Go applications must be **compiled into a binary** before execution.

---

### Initialize Go module

```bash
cd /app
go mod init dispatch
```

---

### Download dependencies

```bash
go get
```

---

### Build the binary

```bash
go build
```

This generates the executable binary:

```text
/app/dispatch
```

---

## 6Ô∏è‚É£ Configure systemd Service

### Why systemd?

Using systemd provides:

* Automatic startup on reboot
* Process supervision
* Centralized logging

---

### Create service file

```bash
vim /etc/systemd/system/dispatch.service
```

---

### Dispatch service definition

```ini
[Unit]
Description=Dispatch Service

[Service]
User=roboshop
Environment=AMQP_HOST=<RABBITMQ-IP>
Environment=AMQP_USER=roboshop
Environment=AMQP_PASS=roboshop123
ExecStart=/app/dispatch
SyslogIdentifier=dispatch

[Install]
WantedBy=multi-user.target
```

> ‚ö†Ô∏è Replace `<RABBITMQ-IP>` with the actual RabbitMQ server IP address.

---

## 7Ô∏è‚É£ Load and Start the Service

### Reload systemd

```bash
systemctl daemon-reload
```

---

### Enable service at boot

```bash
systemctl enable dispatch
```

---

### Start service

```bash
systemctl start dispatch
```

---

### Verify service status

```bash
systemctl status dispatch
```

Expected state:

```text
active (running)
```

---

## üîÅ Dispatch Service Workflow

```text
Payment Service
 ‚Üí RabbitMQ
 ‚Üí Dispatch Service
 ‚Üí Order Dispatched
```

This asynchronous flow ensures:

* Loose coupling
* Better scalability
* Reliable order processing

---

## üö® Common Issues & Fixes

| Issue                | Cause             | Fix                    |
| -------------------- | ----------------- | ---------------------- |
| Binary not found     | Build not run     | Execute `go build`     |
| Service not starting | Wrong RabbitMQ IP | Verify AMQP_HOST       |
| Auth failure         | Wrong credentials | Check AMQP user/pass   |
| Permission denied    | Wrong user        | Ensure `User=roboshop` |

---

## ‚úÖ Final Checklist

* [x] GoLang installed
* [x] roboshop user created
* [x] Application code deployed
* [x] Go binary built successfully
* [x] systemd service configured
* [x] RabbitMQ connectivity verified


üöÄ **Dispatch microservice setup is complete and fully integrated with RoboShop.**
